# Chimera Operator Configuration
# v7.1

server:
  host: "0.0.0.0"
  port: 8080
  request_timeout_ms: 30000

rpc:
  primary_provider: "helius"
  # Override via CHIMERA_RPC__PRIMARY_URL env var
  primary_url: "https://api.devnet.solana.com"
  # Override via CHIMERA_RPC__FALLBACK_URL env var
  fallback_url: "https://api.devnet.solana.com"
  rate_limit_per_second: 40
  timeout_ms: 2000
  max_consecutive_failures: 3

database:
  path: "data/chimera.db"
  max_connections: 5

security:
  # Overridden by CHIMERA_SECURITY__WEBHOOK_SECRET
  webhook_secret: "dev-secret-placeholder"
  max_timestamp_drift_secs: 60
  webhook_rate_limit: 100
  webhook_burst_size: 150
  # Admin wallets for API access
  admin_wallets:
    - address: "7s79kvpdcGzjHF4bHtJVEbd9p2eESZ9kv1hNjhgBepCp"
      role: "admin"
  # API keys for automated scripts
  api_keys:
    - key: "dev-admin-key"
      role: "admin"

circuit_breakers:
  max_loss_24h_usd: 500
  max_consecutive_losses: 5
  max_drawdown_percent: 15
  cooldown_minutes: 30

strategy:
  shield_percent: 70
  spear_percent: 30
  max_position_sol: 1.0
  min_position_sol: 0.01

jito:
  enabled: true  # Overridden by CHIMERA_JITO__ENABLED env var for mainnet-paper
  tip_floor_sol: 0.001
  tip_ceiling_sol: 0.01
  tip_percentile: 50
  tip_percent_max: 0.10

jupiter:
  api_url: "https://lite-api.jup.ag/swap/v1"
  # devnet_simulation_mode: Set via CHIMERA_JUPITER__DEVNET_SIMULATION_MODE env var

queue:
  capacity: 1000
  load_shed_threshold_percent: 80

token_safety:
  # Known safe tokens (allowed to have freeze/mint authority)
  freeze_authority_whitelist:
    - "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"  # USDC
    - "Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"  # USDT
    - "So11111111111111111111111111111111111111112"   # Wrapped SOL
  mint_authority_whitelist:
    - "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"  # USDC
    - "Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"  # USDT
    - "So11111111111111111111111111111111111111112"   # Wrapped SOL
  # Minimum liquidity thresholds (USD) - with 20% buffer for safety
  min_liquidity_shield_usd: 12000  # 20% buffer over 10k base
  min_liquidity_spear_usd: 6000    # 20% buffer over 5k base
  # Enable honeypot detection via transaction simulation
  honeypot_detection_enabled: true
  # Token cache settings
  cache_capacity: 1000
  cache_ttl_seconds: 3600  # 1 hour

# Notification settings
notifications:
  telegram:
    enabled: true
    # Set via environment: TELEGRAM_BOT_TOKEN
    bot_token: "${TELEGRAM_BOT_TOKEN}"
    # Set via environment: TELEGRAM_CHAT_ID  
    chat_id: "${TELEGRAM_CHAT_ID}"
    rate_limit_seconds: 60
  rules:
    circuit_breaker_triggered: true
    wallet_drained: true
    position_exited: true
    wallet_promoted: true
    daily_summary: true
    rpc_fallback: true
  daily_summary:
    enabled: true
    hour_utc: 20  # 8 PM UTC
    minute: 0

# Monitoring configuration
monitoring:
  enabled: true
  helius_api_key: "609cb910-17a5-4a76-9d1b-2ca9c42f759e"
  helius_webhook_url: "http://operator:8080/api/v1/monitoring/helius"
  webhook_registration_batch_size: 10
  webhook_registration_delay_ms: 200
  webhook_processing_rate_limit: 45
  rpc_polling_enabled: true
  rpc_poll_interval_secs: 8
  rpc_poll_batch_size: 6
  rpc_poll_rate_limit: 40
  max_active_wallets: 20
  auto_demote_wallets: true  # Enable automatic wallet demotion based on copy performance

# Profit management configuration
profit_management:
  targets: [25, 50, 100, 200]  # Percentage targets
  tiered_exit_percent: 25       # Sell 25% at each target
  trailing_stop_activation: 50  # Activate after +50%
  trailing_stop_distance: 20    # -20% from peak
  hard_stop_loss: 15            # -15% max loss
  time_exit_hours: 24           # Exit profitable positions after 24h

# Position sizing configuration
position_sizing:
  base_size_sol: 0.1
  max_size_sol: 2.0
  min_size_sol: 0.02
  consensus_multiplier: 2.0  # Increased from 1.5x to 2.0x for stronger consensus signals
  max_concurrent_positions: 5
  use_kelly_sizing: false  # Enable Kelly Criterion sizing (Phase 2)

# MEV protection configuration
mev_protection:
  always_use_jito: true
  exit_tip_sol: 0.0055  # Reduced by 20% from 0.007
  consensus_tip_sol: 0.0024  # Reduced by 20% from 0.003
  standard_tip_sol: 0.0012  # Reduced by 20% from 0.0015
